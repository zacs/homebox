---
- name: update homebrew
  command: brew update
  when: ansible_os_family == 'Darwin'

- name: add taps
  homebrew_tap: tap={{ item }} state=present
  with_items:
    - caskroom/cask
    - caskroom/versions
  when: ansible_os_family == 'Darwin'

- name: install CLI tools (OSX)
  homebrew: name={{ item }} state=present
  with_items:
    - git
    - brew-cask
    - wget
    - hub
    - python
    - node
    - brew-gem
    - brew-pip
    - watchman
    - ffmpeg
    - youtube-dl
    - zsh
  when: ansible_os_family == 'Darwin'

- name: install binary casks
  homebrew_cask: name={{ item }} state=present
  with_items:
    - beamer
    - plex-media-server

- name: download IPTV plex plugin
  unarchive: copy=no src=https://github.com/Cigaras/IPTV.bundle/archive/master.zip dest=~Library/Application Support/Plex Media Server/Plug-ins
  when: ansible_os_family == 'Darwin'

- name: rename IPTV bundle
  command: mv ~Library/Application Support/Plex Media Server/Plug-ins/IPTV.bundle-master to ~Library/Application Support/Plex Media Server/Plug-ins/IPTV.bundle
  when: ansible_os_family == 'Darwin'

# TODO: update the m3u location to be a remote http link for easier updating (via dropbox)

# TODO: create a media/movies/videos folder in ~ and add it as a library in plex via configs
